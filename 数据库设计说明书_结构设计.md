### 2.3.1 概念结构设计

本数据库中包含的实体有

- base数据表（所有数据表的父类）：
  状态（删除或未删除） 修改时间，创建时间

- user数据表：
  id（主键） username email gender avatar password（加密后的）openid

- Administrator数据表（继承user，表示餐厅管理员）：
  rid（外键，与restaurant数据表连接）

- FoodCat（食品分类）数据表：

  id（主键）name rid（外键，与restaurant数据表连接）weight

- cart数据表：
  id(主键)，uid（外键，表示user），did（外键，表示dish），quantity（表示数量）orderid（外键，表示Order）

- dish数据表：
  id（主键），rid（外键，表示restaurant）,name,price,summary.stock,tag,main_image

- order数据表（订单):
  id,order_sn（订单流水号）,uid（外键，用户）,cid（外键，优惠券）,total_price（菜单价格）,fair_price（运费价格）,pay_price（支付价格）,pay_sn（支付流水号）,prepay_id（预支付id）,note（备注）,express_status（送货状态）,comment_status（评价状态）,aid（外键，送货地址）,pay_time（支付时间）

- coupon数据表：
  id（主键），uid（外键，用户）,discount（优惠价格）,expiration_date（过期时间）

- FoodStockChangeLog数据表：

  id（主键）food_id  unit  total_stock  note  created_time

- comment数据表：
  id（主键），oid（外键，订单），score（评分），content（评价内容）

- restaurant数据表：
  id(主键)，aid（外键，表示address），name,summary,main_image,month_count,total_count,view_count,comment_count

- Image数据表：

  id（主键）file_key  created_time

### 2.3.2 逻辑结构设计

本数据库包含的关系如下所示

- Own

  User : Cart = 1 : N

- Obtain

  User : Coupon = 1 : N

- Is

  User : Administrator = 1 : N

- Make

  User : Order = 1 : N

- Live in

  User : Address = N : N

- Contain

  Cart : Dish = N : N

- Locate

  Restaurant : Address = 1 : 1

- Manage

  Administrator : Restaurant = 1 : N

- Cook

  Restaurant : Dish = N : N

- Send to

  Address : Order = 1 : 1

- Use

  Order : Coupon = 1 : N

- Have

  Order : Comment = 1 : 1

- Maintain

  Restaurant : FoodCat = 1 : N

- Has

  Restaurant : FoodStockChangeLog = 1 : N

### 2.3.3 物理结构设计

本数据库基于sqlalchemy与mysql，故无需考虑物理结构设计
